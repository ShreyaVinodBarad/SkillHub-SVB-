<!-- This HTML file is in templates folder! -->
<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>To-Do App with Flask</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="d-flex justify-content-center align-items-center vh-100">
    <div class="card">
        <div class="card-body">
            <h1 class="alert alert-info">To - Do App using Flask</h1>
            <form id="todoForm">
                <input type="text" id="task" class="form-control">
                <button type="submit" class="btn btn-success w-100 mt-4">
                    Add
                </button>
            </form>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // const API_URL = "https://flask-crud-r0uz.onrender.com"
        const API_URL = "http://127.0.0.1:5000"
        // ðŸ‘† Saves the backend API base URL (your Flask server running locally).
        document.getElementById("todoForm").addEventListener("submit", async (e) => {
            // ðŸ‘† Finds the form with id todoForm and runs this function when the form is submitted.
            e.preventDefault()
            // ðŸ‘† Stops the page from refreshing after submitting the form.
            const task = document.getElementById("task").value
            // ðŸ‘† Gets the value (text) entered in the input field with id task.
            if (!task) return alert("Enter a task!");
            // ðŸ‘† If the input is empty, shows an alert and stops the function.
            await fetch(`${API_URL}/create`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ task })
            });
            // ðŸ‘† Sends the new task to the backend (/create route) using a POST request with JSON data.
            /*
            ðŸ‘† 
            - fetch(...) â†’ makes a network request to your backend (/create endpoint).
            - method: "POST" â†’ tells the server we are sending data (not just reading).
            - headers: { "Content-Type": "application/json" } â†’ tells the server the data is in JSON format.
            - body: JSON.stringify({ task }) â†’ converts the task (JavaScript object) into a JSON string before sending.
            - await â†’ waits until the request finishes before moving to the next line.
            - So basically: It sends the new task to your backend as JSON.
            */

            document.getElementById("todoForm").reset()
            // ðŸ‘† Clears the form input after submitting.
            fetchTodos()
            // ðŸ‘† Calls the function to refresh and show the updated list of tasks.
        })

        async function fetchTodos() {
            // ðŸ‘† Defines an async function to get tasks from backend.
            const res = await fetch(`${API_URL}/read`)
            // ðŸ‘† Makes a GET request to /read to fetch all tasks.
            const data = await res.json()
            // ðŸ‘† Converts the response into JSON format (list of tasks).
            console.log(data)
            // ðŸ‘† Prints the tasks in the browser console.
        }
    </script>
</body>

</html>